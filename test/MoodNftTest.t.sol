// SPDX-License-Identifier: MIT
pragma solidity ^0.8.28;

import {Test, console} from "forge-std/Test.sol";

import {MoodNFT} from "../src/MoodNFT.sol";
import {DeployMoodNft} from "../script/DeployMoodNft.s.sol";
contract MoodNFTTest is Test {
    MoodNFT moodNft ;
    string public constant HAPPY = "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPGRlZnM+CiAgICA8IS0tIEZhY2UgZ3JhZGllbnQgLS0+CiAgICA8cmFkaWFsR3JhZGllbnQgaWQ9ImZhY2VHcmFkaWVudCIgY3g9IjUwJSIgY3k9IjM1JSIgcj0iNjUlIj4KICAgICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI0ZGRTI3QSIvPgogICAgICA8c3RvcCBvZmZzZXQ9IjYwJSIgc3RvcC1jb2xvcj0iI0ZGQzgzRCIvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNGNEEzMDAiLz4KICAgIDwvcmFkaWFsR3JhZGllbnQ+CgogICAgPCEtLSBFeWUgc2hpbmUgLS0+CiAgICA8cmFkaWFsR3JhZGllbnQgaWQ9ImV5ZVNoaW5lIiBjeD0iMzAlIiBjeT0iMzAlIiByPSI3MCUiPgogICAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdG9wLWNvbG9yPSIjNTU1Ii8+CiAgICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iIzExMSIvPgogICAgPC9yYWRpYWxHcmFkaWVudD4KICA8L2RlZnM+CgogIDwhLS0gRmFjZSAtLT4KICA8Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIHI9IjkwIiBmaWxsPSJ1cmwoI2ZhY2VHcmFkaWVudCkiIC8+CgogIDwhLS0gRXllcyAtLT4KICA8Y2lyY2xlIGN4PSI2NSIgY3k9Ijg1IiByPSIxMiIgZmlsbD0idXJsKCNleWVTaGluZSkiIC8+CiAgPGNpcmNsZSBjeD0iMTM1IiBjeT0iODUiIHI9IjEyIiBmaWxsPSJ1cmwoI2V5ZVNoaW5lKSIgLz4KCiAgPCEtLSBFeWUgaGlnaGxpZ2h0cyAtLT4KICA8Y2lyY2xlIGN4PSI2MCIgY3k9IjgwIiByPSI0IiBmaWxsPSIjZmZmIiBvcGFjaXR5PSIwLjgiLz4KICA8Y2lyY2xlIGN4PSIxMzAiIGN5PSI4MCIgcj0iNCIgZmlsbD0iI2ZmZiIgb3BhY2l0eT0iMC44Ii8+CgogIDwhLS0gU21pbGUgLS0+CiAgPHBhdGggZD0iTTYwIDEyNSBRMTAwIDE2NSAxNDAgMTI1IgogICAgICAgIGZpbGw9Im5vbmUiCiAgICAgICAgc3Ryb2tlPSIjNkIzRTAwIgogICAgICAgIHN0cm9rZS13aWR0aD0iOCIKICAgICAgICBzdHJva2UtbGluZWNhcD0icm91bmQiLz4KCiAgPCEtLSBDaGVlayBibHVzaCAtLT4KICA8ZWxsaXBzZSBjeD0iNTAiIGN5PSIxMjAiIHJ4PSIxNSIgcnk9IjgiIGZpbGw9IiNGRjhGQTMiIG9wYWNpdHk9IjAuMzUiLz4KICA8ZWxsaXBzZSBjeD0iMTUwIiBjeT0iMTIwIiByeD0iMTUiIHJ5PSI4IiBmaWxsPSIjRkY4RkEzIiBvcGFjaXR5PSIwLjM1Ii8+Cjwvc3ZnPgo=" ;
    string public constant SAD = "data:application/json;base64,eyJuYW1lIjoiTW9vZE5GVCIsICJkZXNjcmlwdGlvbiI6IkFuIE5GVCB0aGF0IHJlZmxlY3RzIHRoZSBtb29kIG9mIHRoZSBvd25lciwgMTAwJSBvbiBDaGFpbiEiLCAiYXR0cmlidXRlcyI6IFt7InRyYWl0X3R5cGUiOiAibW9vZGluZXNzIiwgInZhbHVlIjogMTAwfV0sICJpbWFnZSI6ImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjNhV1IwYUQwaU1qQXdJaUJvWldsbmFIUTlJakl3TUNJZ2RtbGxkMEp2ZUQwaU1DQXdJREl3TUNBeU1EQWlJSGh0Ykc1elBTSm9kSFJ3T2k4dmQzZDNMbmN6TG05eVp5OHlNREF3TDNOMlp5SStDaUFnUEdSbFpuTStDaUFnSUNBOElTMHRJRVpoWTJVZ1ozSmhaR2xsYm5RZ0xTMCtDaUFnSUNBOGNtRmthV0ZzUjNKaFpHbGxiblFnYVdROUltWmhZMlZIY21Ga2FXVnVkQ0lnWTNnOUlqVXdKU0lnWTNrOUlqTTFKU0lnY2owaU5qVWxJajRLSUNBZ0lDQWdQSE4wYjNBZ2IyWm1jMlYwUFNJd0pTSWdjM1J2Y0MxamIyeHZjajBpSTBaR1JUSTNRU0l2UGdvZ0lDQWdJQ0E4YzNSdmNDQnZabVp6WlhROUlqWXdKU0lnYzNSdmNDMWpiMnh2Y2owaUkwWkdRemd6UkNJdlBnb2dJQ0FnSUNBOGMzUnZjQ0J2Wm1aelpYUTlJakV3TUNVaUlITjBiM0F0WTI5c2IzSTlJaU5HTkVFek1EQWlMejRLSUNBZ0lEd3ZjbUZrYVdGc1IzSmhaR2xsYm5RK0Nnb2dJQ0FnUENFdExTQkZlV1VnWjNKaFpHbGxiblFnTFMwK0NpQWdJQ0E4Y21Ga2FXRnNSM0poWkdsbGJuUWdhV1E5SW1WNVpWTm9ZV1JsSWlCamVEMGlNekFsSWlCamVUMGlNekFsSWlCeVBTSTNNQ1VpUGdvZ0lDQWdJQ0E4YzNSdmNDQnZabVp6WlhROUlqQWxJaUJ6ZEc5d0xXTnZiRzl5UFNJak5UVTFJaTgrQ2lBZ0lDQWdJRHh6ZEc5d0lHOW1abk5sZEQwaU1UQXdKU0lnYzNSdmNDMWpiMnh2Y2owaUl6RXhNU0l2UGdvZ0lDQWdQQzl5WVdScFlXeEhjbUZrYVdWdWRENEtDaUFnSUNBOElTMHRJRlJsWVhJZ1ozSmhaR2xsYm5RZ0xTMCtDaUFnSUNBOGJHbHVaV0Z5UjNKaFpHbGxiblFnYVdROUluUmxZWEpIY21Ga2FXVnVkQ0lnZURFOUlqQWlJSGt4UFNJd0lpQjRNajBpTUNJZ2VUSTlJakVpUGdvZ0lDQWdJQ0E4YzNSdmNDQnZabVp6WlhROUlqQWxJaUJ6ZEc5d0xXTnZiRzl5UFNJak9VSkZOMFpHSWk4K0NpQWdJQ0FnSUR4emRHOXdJRzltWm5ObGREMGlNVEF3SlNJZ2MzUnZjQzFqYjJ4dmNqMGlJek5FUWpsR1JpSXZQZ29nSUNBZ1BDOXNhVzVsWVhKSGNtRmthV1Z1ZEQ0S0lDQThMMlJsWm5NK0Nnb2dJRHdoTFMwZ1JtRmpaU0F0TFQ0S0lDQThZMmx5WTJ4bElHTjRQU0l4TURBaUlHTjVQU0l4TURBaUlISTlJamt3SWlCbWFXeHNQU0oxY213b0kyWmhZMlZIY21Ga2FXVnVkQ2tpSUM4K0Nnb2dJRHdoTFMwZ1JYbGxjeUF0TFQ0S0lDQThZMmx5WTJ4bElHTjRQU0kyTlNJZ1kzazlJamt3SWlCeVBTSXhNQ0lnWm1sc2JEMGlkWEpzS0NObGVXVlRhR0ZrWlNraUlDOCtDaUFnUEdOcGNtTnNaU0JqZUQwaU1UTTFJaUJqZVQwaU9UQWlJSEk5SWpFd0lpQm1hV3hzUFNKMWNtd29JMlY1WlZOb1lXUmxLU0lnTHo0S0NpQWdQQ0V0TFNCRmVXVWdhR2xuYUd4cFoyaDBjeUF0TFQ0S0lDQThZMmx5WTJ4bElHTjRQU0kyTVNJZ1kzazlJamcySWlCeVBTSXpJaUJtYVd4c1BTSWpabVptSWlCdmNHRmphWFI1UFNJd0xqY2lMejRLSUNBOFkybHlZMnhsSUdONFBTSXhNekVpSUdONVBTSTROaUlnY2owaU15SWdabWxzYkQwaUkyWm1aaUlnYjNCaFkybDBlVDBpTUM0M0lpOCtDZ29nSUR3aExTMGdVMkZrSUcxdmRYUm9JQzB0UGdvZ0lEeHdZWFJvSUdROUlrMDJNQ0F4TkRBZ1VURXdNQ0F4TURVZ01UUXdJREUwTUNJS0lDQWdJQ0FnSUNCbWFXeHNQU0p1YjI1bElnb2dJQ0FnSUNBZ0lITjBjbTlyWlQwaUl6WkNNMFV3TUNJS0lDQWdJQ0FnSUNCemRISnZhMlV0ZDJsa2RHZzlJamdpQ2lBZ0lDQWdJQ0FnYzNSeWIydGxMV3hwYm1WallYQTlJbkp2ZFc1a0lpOCtDZ29nSUR3aExTMGdWR1ZoY2lBdExUNEtJQ0E4Y0dGMGFDQmtQU0pOTVRRd0lERXdOU0JETVRVd0lERXlNQ0F4TlRBZ01UUXdJREV6TlNBeE5UQWdRekV5TUNBeE5EQWdNVEl3SURFeU1DQXhNekFnTVRBMUlGb2lDaUFnSUNBZ0lDQWdabWxzYkQwaWRYSnNLQ04wWldGeVIzSmhaR2xsYm5RcElpQnZjR0ZqYVhSNVBTSXdMamtpTHo0S1BDOXpkbWMrQ2c9PSJ9";
    address public user = makeAddr("USER");

    function setUp() public {
        moodNft = new MoodNFT(HAPPY , SAD) ;

    }

    function testViewTokenURI() public  {
        vm.prank(user);
        moodNft.mintNft();
        console.log(moodNft.tokenURI(0));
    }

    function testFlipMood() public {
        vm.prank(user);
        moodNft.mintNft();

        vm.prank(user);
        moodNft.flipMood(0);
        console.log(moodNft.tokenURI(0));
        console.log("Expected URI : " , SAD);
        assert(
            keccak256(abi.encodePacked(moodNft.tokenURI(0))) == keccak256(abi.encodePacked(SAD))
        );
    }



}
